{% extends "base.html.twig" %}

{% block page_content %}
    <div id="page-content" class="page-content">
        <h1>{{ page.title }}</h1>
        
        {# Vykreslení vlastního obsahu blog index stránky (pokud je nějaký) #}
        {{ content | safe }}

        {# Loop přes články #}
        {% for article in articles %}
            <article class="blog-post">
                <h2><a href="{{ article.url }}">{{ article.title }}</a></h2>
                
                {# Datum (pro budoucí implementaci) #}
                {% if blog_config.date and article.date %}
                    <p class="blog-date">Published: {{ article.date }}</p>
                {% endif %}
                
                {# Celý obsah příspěvku (včetně HTML) #}
                <div class="blog-content">
                    {% if article.snippet_html %}
                        {{ article.snippet_html | safe }}
                        <p><a href="{{ article.url }}">Číst více ..</a></p>
                    {% else %}
                        {{ article.content_html | safe }}
                    {% endif %}
                </div>
            </article>
            <hr>
        {% else %}
            <p>No blog articles found.</p>
        {% endfor %}

        {# Stránkování #}
        {% if pagination.total > 1 %}
            <div class="blog-pagination-wrapper">
                <nav class="pagination-nav">
                    <ul class="pagination">
                        {# Předchozí stránka #}
                        {% if pagination.has_prev %}
                            <li class="page-item prev">
                                <a class="page-link" href="{{ pagination.base_url }}p={{ pagination.prev_page }}">« Previous</a>
                            </li>
                        {% endif %}

                        {# Čísla stránek (zjednodušená verze) #}
                        {% for i in range(1, pagination.total + 1) %}
                            <li class="page-item {% if i == pagination.current %}active{% endif %}">
                                <a class="page-link" href="{{ pagination.base_url }}p={{ i }}">{{ i }}</a>
                            </li>
                        {% endfor %}
                        
                        {# Další stránka #}
                        {% if pagination.has_next %}
                            <li class="page-item next">
                                <a class="page-link" href="{{ pagination.base_url }}p={{ pagination.next_page }}">Next »</a>
                            </li>
                        {% endif %}
                    </ul>
                </nav>
            </div>
        {% endif %}
    </div>

    {# DŮLEŽITÉ: Vyhledávací kontejner musí být na stránce, aby jej JS mohl přepínat. #}
    <div id="search-container" class="search-container" style="display: none;">
        <div class="container">
            <input type="text" id="search-input" class="search-input" placeholder="Enter at least 3 characters (regex supported)">
            <div id="search-results" class="search-results">
                {# Zde se dynamicky vloží mapa stránek a výsledky vyhledávání #}
            </div>
        </div>
    </div>
{% endblock %}